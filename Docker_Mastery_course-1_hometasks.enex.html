<html>
<head>
  <title>Evernote Export</title>
  <basefont face="Tahoma" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="Evernote Windows/307881 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <style>
    body, td {
      font-family: Tahoma;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="3825"/>

<div>
<span><div><div><div>1</div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image.png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container run --publish 80:80 --detach --name webproxy nginx</span></div><div>efeedbfbca23f9ef441799b021cf6112a6b36a98c61d3b0cc704041c1ad93f63</div><div><br/></div><div>vdanev@ora-vsrv:~$ docker container ls</div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                NAMES</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   10 seconds ago      Up 10 seconds       0.0.0.0:80-&gt;80/tcp   webproxy</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container run --publish 8082:80 --detach --name webserver httpd</span></div><div>abe85d9c18dd1e111ff8b9ebdfc2218ea5fb6a7243b950708da0e69a66650b42</div><div>vdanev@ora-vsrv:~$ docker container ls</div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                  NAMES</div><div>abe85d9c18dd        httpd               &quot;httpd-foreground&quot;       8 seconds ago       Up 6 seconds        0.0.0.0:8082-&gt;80/tcp   webserver</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   2 minutes ago       Up 2 minutes        0.0.0.0:80-&gt;80/tcp     webproxy</div><div><br/></div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">sudo docker container run --env MYSQL_RANDOM_ROOT_PASSWORD=yes --publish 3307:3306 --detach --name dbserver mysql</span></div><div>docker: Error response from daemon: Conflict. The container name &quot;/dbserver&quot; is already in use by container &quot;3a055062f75b78f51b5d82092b3babc478b6f3b68172b126b90343f03a84872c&quot;. You have to remove (or rename) that container to be able to reuse that name.</div><div>See 'docker run --help'.</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls -a</span></div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS                  NAMES</div><div><span style="font-weight: bold;">3a0</span>55062f75b        mysql               &quot;docker-entrypoint.s…&quot;   6 minutes ago       Exited (1) 6 minutes ago                           <span style="font-weight: bold;">dbserver</span></div><div>abe85d9c18dd        httpd               &quot;httpd-foreground&quot;       12 minutes ago      Up 12 minutes               0.0.0.0:8082-&gt;80/tcp   webserver</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   14 minutes ago      Up 14 minutes               0.0.0.0:80-&gt;80/tcp     webproxy</div><div>f95aa2710016        hello-world         &quot;/hello&quot;                 28 minutes ago      Exited (0) 28 minutes ago                          agitated_shtern</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container rm 3a0</span></div><div>3a0</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">sudo docker container run --env MYSQL_RANDOM_ROOT_PASSWORD=yes --publish 3307:3306 --detach --name dbserver mysql</span></div><div>df0d4d2738e23a15c71239e8d5ad687b16578ca460cee40f5e62f747f9f53046</div><div>vdanev@ora-vsrv:~$ docker container ls</div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</div><div><span style="font-weight: bold;">df0</span>d4d2738e2        mysql               &quot;docker-entrypoint.s…&quot;   6 seconds ago       Up 5 seconds        33060/tcp, 0.0.0.0:3307-&gt;3306/tcp   dbserver</div><div>abe85d9c18dd        httpd               &quot;httpd-foreground&quot;       12 minutes ago      Up 12 minutes       0.0.0.0:8082-&gt;80/tcp                webserver</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   14 minutes ago      Up 14 minutes       0.0.0.0:80-&gt;80/tcp                  webproxy</div><div><br/></div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container logs df0</span></div><div>Warning: Unable to load '/usr/share/zoneinfo/zone1970.tab' as time zone. Skipping it.</div><div>GENERATED ROOT PASSWORD: <span style="font-weight: bold;">aizo5eehaemeThaeghai4phievegho0t</span></div><div>2018-10-28T14:57:22.388681Z 10 [Warning] [MY-010315] [Server] 'user' entry 'mysql.infoschema@localhost' ignored in --skip-name-resolve mode.</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls</span></div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</div><div>df0d4d2738e2        mysql               &quot;docker-entrypoint.s…&quot;   6 minutes ago       Up 6 minutes        33060/tcp, 0.0.0.0:3307-&gt;3306/tcp   dbserver</div><div>abe85d9c18dd        httpd               &quot;httpd-foreground&quot;       18 minutes ago      Up 18 minutes       0.0.0.0:8082-&gt;80/tcp                webserver</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   20 minutes ago      Up 20 minutes       0.0.0.0:80-&gt;80/tcp                  webproxy</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container stop dbserver webserver webproxy</span></div><div>dbserver</div><div>webserver</div><div>webproxy</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls</span></div><div>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls -a</span></div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS                      PORTS               NAMES</div><div>df0d4d2738e2        mysql               &quot;docker-entrypoint.s…&quot;   7 minutes ago       Exited (0) 24 seconds ago                       dbserver</div><div>abe85d9c18dd        httpd               &quot;httpd-foreground&quot;       19 minutes ago      Exited (0) 26 seconds ago                       webserver</div><div>efeedbfbca23        nginx               &quot;nginx -g 'daemon of…&quot;   21 minutes ago      Exited (0) 26 seconds ago                       webproxy</div><div>f95aa2710016        hello-world         &quot;/hello&quot;                 35 minutes ago      Exited (0) 35 minutes ago                       agitated_shtern</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container rm dbserver webserver webproxy agitated_shtern</span></div><div>dbserver</div><div>webserver</div><div>webproxy</div><div>agitated_shtern</div><div><br/></div><h3><span style="font-size: 11pt;"><a href="https://docs.docker.com/engine/reference/commandline/run/#publish-or-expose-port--p---expose" style="font-size: 11pt; font-weight: bold;">https://docs.docker.com/engine/reference/commandline/run/#publish-or-expose-port--p---expose</a></span></h3><h3>Set environment variables (-e, --env, --env-file)</h3><div>$ docker run -e MYVAR1 --env MYVAR2=foo --env-file ./env.list ubuntu bash</div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">Use the</span> <span style="-en-paragraph:true;">-e</span><span style="-en-paragraph:true;">,</span> <span style="-en-paragraph:true;">--env</span><span style="-en-paragraph:true;">, and</span> <span style="-en-paragraph:true;">--env-file</span> <span style="-en-paragraph:true;">flags to set simple (non-array) environment variables in the container you’re running, or overwrite variables that are defined in the Dockerfile of the image you’re running.</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">You can define the variable and its value when running the container:</span></div><div>$ docker run --env VAR1=value1 --env VAR2=value2 ubuntu env | grep VAR</div><div>VAR1=value1</div><div>VAR2=value2</div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">docker container run --env MYSQL_RANDOM_ROOT_PASSWORD=true -p 3307:3306 --d --name mysql mysql</span></div></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;"><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [1].png" type="image/png" data-filename="Image.png"/></span></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">1</span></div><div><span style="font-weight: bold;">docker container run --rm -it  ubuntu:14.04 bash</span></div><div><span style="font-weight: bold;">Unable to find image 'ubuntu:14.04' locally</span></div><div><span style="font-weight: bold;">14.04: Pulling from library/ubuntu</span></div><div><span style="font-weight: bold;">027274c8e111: Pull complete</span></div><div><span style="font-weight: bold;">d3f9339a1359: Pull complete</span></div><div><span style="font-weight: bold;">872f75707cf4: Pull complete</span></div><div><span style="font-weight: bold;">dd5eed9f50d5: Pull complete</span></div><div><span style="font-weight: bold;">Digest: sha256:e6e808ab8c62f1d9181817aea804ae4ba0897b8bd3661d36dbc329b5851b5637</span></div><div><span style="font-weight: bold;">Status: Downloaded newer image for ubuntu:14.04</span></div><div><br/></div><div><span style="font-weight: bold;">root@b4cf973c7fcd:/# export http_proxy=</span><a href="http://10.1.32.100:8081/" style="font-weight: bold;">http://10.1.32.100:8081</a></div><div><span style="font-weight: bold;">root@b4cf973c7fcd:/# apt update</span></div><div><span style="font-weight: bold;">Ign</span> <a href="http://archive.ubuntu.com/" style="font-weight: bold;">http://archive.ubuntu.com</a> <span style="font-weight: bold;">trusty InRelease</span></div><div><span style="font-weight: bold;">Get:1</span> <a href="http://security.ubuntu.com/" style="font-weight: bold;">http://security.ubuntu.com</a> <span style="font-weight: bold;">trusty-security InRelease [65.9 kB]</span></div><div><span style="font-weight: bold;">Get:2</span> <a href="http://security.ubuntu.com/" style="font-weight: bold;">http://security.ubuntu.com</a> <span style="font-weight: bold;">trusty-security/main</span></div><div><br/></div><div><span style="font-weight: bold;">[root@7f0cb4501789 /]# curl --version</span></div><div><span style="font-weight: bold;">curl 7.29.0 (x86_64-redhat-linux-gnu) libcurl/7.29.0 NSS/3.34 zlib/1.2.7 libidn/1.28 libssh2/1.4.3</span></div><div><span style="font-weight: bold;">Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtsp scp sftp smtp smtps telnet tftp</span></div><div><span style="font-weight: bold;">Features: AsynchDNS GSS-Negotiate IDN IPv6 Largefile NTLM NTLM_WB SSL libz unix-sockets</span></div><div><br/></div><div><br/></div><div><br/></div><div><span style="font-weight: bold;">docker container run --rm -it centos:7 bash</span></div><div><br/></div><div><span style="font-weight: bold;">export http_proxy=</span><a href="http://10.1.32.100:8081/" style="font-weight: bold;">http://10.1.32.100:8081</a></div><div><br/></div><div><span style="font-weight: bold;">[root@7f0cb4501789 /]# curl --version</span></div><div><br/></div><div>curl 7.29.0 (x86_64-redhat-linux-gnu) libcurl/7.29.0 NSS/3.34 zlib/1.2.7 libidn/1.28 libssh2/1.4.3</div><div>Protocols: dict file ftp ftps gopher http https imap imaps ldap ldaps pop3 pop3s rtsp scp sftp smtp smtps telnet tftp</div><div>Features: AsynchDNS GSS-Negotiate IDN IPv6 Largefile NTLM NTLM_WB SSL libz unix-sockets</div><div><br/></div><div><br/></div><div><span style="font-size: 16pt; font-weight: bold;">Ключ --rm - позволяет после выхода из контейнера по команде ls -a не видеть запущенный ранее контейнер, т.е. он удаляется</span></div><div><br/></div><div><span style="font-weight: bold;"><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [2].png" type="image/png" data-filename="Image.png"/></span></div><div><span style="font-weight: bold;">1</span></div><div><br/></div><div><span style="font-size: 16pt; font-weight: bold;">The correct variants:</span></div><div><span style="font-weight: bold;">docker network create my_privat_net</span></div><div><br/></div><div><span style="font-weight: bold;">vdanev@ora-vsrv:~$ docker container run -d --net my_privat_net --net-alias search elasticsearch:2</span></div><div><span style="font-weight: bold;">00a8151eb86069093ab67d4d8f33f21b87f6baa4a034f237cdbbb8ce6b7bc3b1</span></div><div><br/></div><div><span style="font-weight: bold;">vdanev@ora-vsrv:~$ docker container run -d --net my_privat_net --net-alias search elasticsearch:2</span></div><div><span style="font-weight: bold;">5fe9775c32d1f2f35989545a95dce6e6c6800ebeee42988d51727b97dfbe3dc8</span></div><div><br/></div><div>danev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>CONTAINER ID        IMAGE               COMMAND                  CREATED              STATUS              PORTS                               NAMES</div><div>5fe9775c32d1        elasticsearch:2     &quot;/docker-entrypoint.…&quot;   About a minute ago   Up About a minute   9200/tcp, 9300/tcp                  blissful_noether</div><div>00a8151eb860        elasticsearch:2     &quot;/docker-entrypoint.…&quot;   About a minute ago   Up About a minute   9200/tcp, 9300/tcp                  nervous_darwin</div></div><div><br/></div><div><span style="font-weight: bold;">vdanev@ora-vsrv:~$ docker container run --rm --net my_privat_net alpine nslookup search</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>nslookup: can't resolve '(null)': Name does not resolve</div><div>Name:      search</div><div>Address 1: 172.19.0.2 search.my_privat_net</div><div>Address 2: 172.19.0.3 search.my_privat_net</div></div><div><br/></div><div><span style="font-weight: bold;">vdanev@ora-vsrv:~$ docker container run --rm --net my_privat_net centos curl -s search:9200</span></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>{</div><div>  &quot;name&quot; : &quot;Miles Warren&quot;,</div><div>  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,</div><div>  &quot;cluster_uuid&quot; : &quot;YjxgAyH7QVmCgVkclA4zgQ&quot;,</div><div>  &quot;version&quot; : {</div><div>    &quot;number&quot; : &quot;2.4.6&quot;,</div><div>    &quot;build_hash&quot; : &quot;5376dca9f70f3abef96a77f4bb22720ace8240fd&quot;,</div><div>    &quot;build_timestamp&quot; : &quot;2017-07-18T12:17:44Z&quot;,</div><div>    &quot;build_snapshot&quot; : false,</div><div>    &quot;lucene_version&quot; : &quot;5.5.4&quot;</div><div>  },</div><div>  &quot;tagline&quot; : &quot;You Know, for Search&quot;</div><div>}</div></div><div><br/></div><div><span style="font-size: 16pt; font-weight: bold;">Если запустить еще раз, то ответит уже другой сервер:</span></div><div><span style="font-weight: bold;">vdanev@ora-vsrv:~$ docker container run --rm --net my_privat_net centos curl -s search:9200</span></div><div><span style="font-weight: bold;">{</span></div><div><span style="font-weight: bold;">  &quot;name&quot; : &quot;Bucky III&quot;,</span></div><div><span style="font-weight: bold;">  &quot;cluster_name&quot; : &quot;elasticsearch&quot;,</span></div><div><span style="font-weight: bold;">  &quot;cluster_uuid&quot; : &quot;ztbcYHauRAK47c0Lid_4hg&quot;,</span></div><div><span style="font-weight: bold;">  &quot;version&quot; : {</span></div><div><span style="font-weight: bold;">    &quot;number&quot; : &quot;2.4.6&quot;,</span></div><div><span style="font-weight: bold;">    &quot;build_hash&quot; : &quot;5376dca9f70f3abef96a77f4bb22720ace8240fd&quot;,</span></div><div><span style="font-weight: bold;">    &quot;build_timestamp&quot; : &quot;2017-07-18T12:17:44Z&quot;,</span></div><div><span style="font-weight: bold;">    &quot;build_snapshot&quot; : false,</span></div><div><span style="font-weight: bold;">    &quot;lucene_version&quot; : &quot;5.5.4&quot;</span></div><div><span style="font-weight: bold;">  },</span></div><div><span style="font-weight: bold;">  &quot;tagline&quot; : &quot;You Know, for Search&quot;</span></div><div><span style="font-weight: bold;">}</span></div><div><br/></div><div><br/></div><div><a href="https://docs.docker.com/network/bridge/">https://docs.docker.com/network/bridge/</a></div><h2>Differences between user-defined bridges and the default bridge</h2><ul><li><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold;-en-paragraph:true;">User-defined bridges provide better isolation and interoperability between containerized applications</span><span style="-en-paragraph:true;">.</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">Containers connected to the same user-defined bridge network automatically expose</span> <span style="font-weight: bold;-en-paragraph:true;">all ports</span> <span style="-en-paragraph:true;">to each other, and</span> <span style="font-weight: bold;-en-paragraph:true;">no ports</span> <span style="-en-paragraph:true;">to the outside world. This allows containerized applications to communicate with each other easily, without accidentally opening access to the outside world.</span></div></li><li><div style="margin-top: 1em; margin-bottom: 1em;"><span style="font-weight: bold;-en-paragraph:true;">Containers can be attached and detached from user-defined networks on the fly</span><span style="-en-paragraph:true;">.</span></div><div style="margin-top: 1em; margin-bottom: 1em;"><span style="-en-paragraph:true;">During a container’s lifetime, you can connect or disconnect it from user-defined networks on the fly. To remove a container from the default bridge network, you need to stop the container and recreate it with different network options.</span></div></li><li><div style="margin-top: 1em; margin-bottom: 1em;"><br/></div></li></ul></div><div><br/></div><div>vdanev@ora-vsrv:~/docker/udemy-docker-mastery/dockerfile-assignment-1$ <span style="font-size: 14pt; font-weight: bold;">docker build -t testnode .</span></div><div>Sending build context to Docker daemon  442.4kB</div><div>Step 1/11 : FROM node:6-alpine</div><div>---&gt; ac75c1f95b80</div><div>Step 2/11 : ENV http_proxy &quot;<a href="http://10.1.32.100:8081/">http://10.1.32.100:8081</a>&quot;</div><div>---&gt; Running in 7ebb80de114f</div><div>Removing intermediate container 7ebb80de114f</div><div>---&gt; f4ff41180c7b</div><div>Step 3/11 : ENV https_proxy &quot;<a href="http://10.1.32.100:8081/">http://10.1.32.100:8081</a>&quot;</div><div>---&gt; Running in 6a071797d693</div><div><br/></div><div><br/></div><div>emoving intermediate container 2c174f565ca4</div><div>---&gt; dd9cfcf68dec</div><div>Successfully built dd9cfcf68dec</div><div>Successfully tagged testnode:latest</div><div><br/></div><div>cat Dockerfile (at /home/vdanev/docker/udemy-docker-mastery/dockerfile-assignment-1):</div><div><br/></div><div style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div># use this empty Dockerfile to build your assignment</div><div><br/></div><div># This dir contains a Node.js app, you need to get it running in a container</div><div># No modifications to the app should be necessary, only edit this Dockerfile</div><div><br/></div><div># Overview of this assignment</div><div># use the instructions from developer below to create a working Dockerfile</div><div># feel free to add command inline below or use a new file, up to you (but must be named Dockerfile)</div><div># once Dockerfile builds correctly, start container locally to make sure it works on http://localhost</div><div># then ensure image is named properly for your Docker Hub account with a new repo name</div><div># push to Docker Hub, then go to https://hub.docker.com and verify</div><div># then remove local image from cache</div><div># then start a new container from your Hub image, and watch how it auto downloads and runs</div><div># test again that it works at http://localhost</div><div><br/></div><div><br/></div><div># Instructions from the app developer</div><div># - you should use the 'node' official image, with the alpine 6.x branch</div><div>FROM node:6-alpine</div><div>ENV http_proxy &quot;http://10.1.32.100:8081&quot;</div><div>ENV https_proxy &quot;http://10.1.32.100:8081&quot;</div><div># - this app listens on port 3000, but the container should launch on port 80</div><div>  #  so it will respond to http://localhost:80 on your computer</div><div>EXPOSE 3000</div><div># - then it should use alpine package manager to install tini: 'apk add --update tini'</div><div>RUN apk add --update tini</div><div># - then it should create directory /usr/src/app for app files with 'mkdir -p /usr/src/app'</div><div>RUN mkdir -p /usr/src/app</div><div># - Node uses a &quot;package manager&quot;, so it needs to copy in package.json file</div><div>WORKDIR /usr/src/app  </div><div>COPY package.json package.json</div><div># - then it needs to run 'npm install' to install dependencies from that file</div><div># - to keep it clean and small, run 'npm cache clean --force' after above</div><div>RUN npm install &amp;&amp; npm cache clean --force</div><div># - then it needs to copy in all files from current directory</div><div>COPY . .</div><div># - then it needs to start container with command '/sbin/tini -- node ./bin/www'</div><div># - in the end you should be using FROM, RUN, WORKDIR, COPY, EXPOSE, and CMD commands</div><div>CMD [&quot;tini&quot;, &quot;--&quot;,  &quot;node&quot;, &quot;./bin/www&quot;]</div><div><br/></div><div># Bonus Extra Credit</div><div># this will not have you setting up a complete image useful for local development, test, and prod</div><div># it's just meant to get you started with basic Dockerfile concepts and not focus too much on</div><div># proper Node.js use in a container. **If you happen to be a Node.js Developer**, then</div><div># after you get through more of this course, you should come back and use my</div><div># Node Docker Good Defaults sample project on GitHub to change this Dockerfile for</div><div># better local development with more advanced topics</div><div># https://github.com/BretFisher/node-docker-good-defaults</div></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div>home/vdanev/docker/udemy-docker-mastery/dockerfile-assignment-1</div><div>vdanev@ora-vsrv:~/docker/udemy-docker-mastery/dockerfile-assignment-1$ <span style="font-size: 14pt; font-weight: bold;">docker container run --rm -p 80:3000 testnode</span></div><div>WARNING: Tini has been relocated to /sbin/tini.</div><div>Please update your scripts to use /sbin/tini going forward.</div><div>/usr/bin/tini has been preserved for backwards compatibility in Alpine 3.4,</div><div>but WILL BE REMOVED in Alpine 3.5.</div><div><br/></div><div>GET / 200 88.359 ms - 304</div><div>GET /stylesheets/style.css 200 5.513 ms - 119</div><div>GET /images/picard.gif 200 1.717 ms - 417700</div><div><br/></div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [3].png" type="image/png" data-filename="Image.png"/></div><div>danev@ora-vsrv:~$ <span style="font-weight: bold;">docker images</span></div><div>REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE</div><div><span style="font-weight: bold;">testnode                latest              dd9cfcf68dec        18 minutes ago      63MB</span></div><div>&lt;none&gt;                  &lt;none&gt;              7d1eda5a3351        24 minutes ago      55.2MB</div><div>nginx-with-html         latest              68f60a4ac6ae        13 hours ago        109MB</div><div><br/></div><div>Переименовать теги для image:</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker tag testnode sol22/testing-node</span></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker images</span></div><div>REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE</div><div>testnode                latest              dd9cfcf68dec        20 minutes ago      63MB</div><div><span style="font-weight: bold;">sol22/testing-node      latest              dd9cfcf68dec        20 minutes ago      63MB</span></div><div><br/></div><div><br/></div><div>Загрузить образ в докер-хаб:</div><div>danev@ora-vsrv:~$ <span style="font-weight: bold;">docker push sol22/testing-node</span></div><div>The push refers to repository [docker.io/sol22/testing-node]</div><div>c7cdd676d120: Pushed</div><div>22f501372b69: Pushed</div><div>8318d767dbbd: Pushed</div><div>1f567edfbac0: Pushed</div><div>a1546f78ff0e: Pushed</div><div>e56fda44d385: Mounted from library/node</div><div>4fb126c17f93: Mounted from library/node</div><div>a120b7c9a693: Mounted from library/node</div><div>latest: digest: sha256:ecc4c4c88653496b23c70c2f9b66fd9560f4cf732bfa458f7c13ca31b014a8d5 size: 1996</div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [4].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><br/></div><div>Удалить локально образ:</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker image ls</span></div><div>REPOSITORY              TAG                 IMAGE ID            CREATED             SIZE</div><div>testnode                latest              dd9cfcf68dec        25 minutes ago      63MB</div><div>sol22/testing-node      latest              dd9cfcf68dec        25 minutes ago      63MB</div><div>&lt;none&gt;                  &lt;none&gt;              7d1eda5a3351        31 minutes ago      55.2MB</div><div>nginx-with-html         latest              68f60a4ac6ae        14 hours ago        109MB</div><div>sol22/nginx-with-html   latest              68f60a4ac6ae        14 hours ago        109MB</div><div>customnginx             latest              deedeca2941b        14 hours ago        108MB</div><div>&lt;none&gt;                  &lt;none&gt;              d2b7239dfe10        14 hours ago        108MB</div><div>&lt;none&gt;                  &lt;none&gt;              a366692bf243        14 hours ago        55.3MB</div><div>mysql                   latest              2dd01afbe8df        7 days ago          485MB</div><div>httpd                   latest              55a118e2a010        7 days ago          132MB</div><div>ubuntu                  14.04               f216cfb59484        13 days ago         188MB</div><div>ubuntu                  latest              ea4c82dcd15a        13 days ago         85.8MB</div><div>nginx                   latest              dbfc48660aeb        2 weeks ago         109MB</div><div>debian                  stretch-slim        4b4471f624dc        2 weeks ago         55.3MB</div><div>centos                  7                   75835a67d134        3 weeks ago         200MB</div><div>centos                  latest              75835a67d134        3 weeks ago         200MB</div><div>nginx                   alpine              aae476eee77d        4 weeks ago         17.7MB</div><div>node                    6-alpine            ac75c1f95b80        7 weeks ago         55.2MB</div><div>alpine                  latest              196d12cf6ab1        7 weeks ago         4.41MB</div><div>hello-world             latest              4ab4c602aa5e        7 weeks ago         1.84kB</div><div>elasticsearch           2                   5e9d896dc62c        8 weeks ago         479MB</div><div>debian                  latest              eb03746b21f3        2 years ago         125MB</div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker image rm sol22/testing-node</span></div><div>Untagged: sol22/testing-node:latest</div><div>Untagged: sol22/testing-node@sha256:ecc4c4c88653496b23c70c2f9b66fd9560f4cf732bfa458f7c13ca31b014a8d5</div><div><br/></div><div><span style="font-weight: bold;">Упс- порт 80 занят другим запущенным контейнером:</span></div><div>vdanev@ora-vsrv:~$ docker container run --rm -p 80:3000 sol22/testing-node</div><div>Unable to find image 'sol22/testing-node:latest' locally</div><div>latest: Pulling from sol22/testing-node</div><div>Digest: sha256:ecc4c4c88653496b23c70c2f9b66fd9560f4cf732bfa458f7c13ca31b014a8d5</div><div>Status: Downloaded newer image for sol22/testing-node:latest</div><div>docker: Error response from daemon: driver failed programming external connectivity on endpoint flamboyant_chaplygin (28f938288a5fa1bddaf862aefbe80fe91d2732dadfa3f215c9df829b0aceba36): Bind for 0.0.0.0:80 failed: port is already allocated.</div><div>vdanev@ora-vsrv:~$</div><div><br/></div><div><span style="font-weight: bold;">Запустить контейнер из образа на хабе:</span></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container run --rm -p 80:3000 sol22/testing-node</span></div><div>WARNING: Tini has been relocated to /sbin/tini.</div><div>Please update your scripts to use /sbin/tini going forward.</div><div>/usr/bin/tini has been preserved for backwards compatibility in Alpine 3.4,</div><div>but WILL BE REMOVED in Alpine 3.5.</div><div><br/></div><div>GET / 304 95.528 ms - -</div><div>GET /stylesheets/style.css 304 2.618 ms - -</div><div>GET /images/picard.gif 304 0.822 ms - -</div><div>GET / 304 5.640 ms - -</div><div>GET /stylesheets/style.css 304 1.216 ms - -</div><div>GET /images/picard.gif 304 0.410 ms - -</div><div>GET / 304 5.986 ms - -</div><div>GET /stylesheets/style.css 304 0.311 ms - -</div><div><br/></div><div><span style="font-weight: bold;">Все работает:</span></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [5].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [6].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container run -d --name postgres -p 5432:5432 -e http_proxy=</span><a href="http://10.1.32.100:8080/" style="font-weight: bold;">http://10.1.32.100:8080</a> <span style="font-weight: bold;">-v postgres:/var/lib/postgresql/data postgres:9.6.1</span></div><div>Unable to find image 'postgres:9.6.1' locally</div><div>9.6.1: Pulling from library/postgres</div><div>5040bd298390: Pull complete</div><div>...</div><div>Digest: sha256:0842a7ef786aa2658623085160cb38451eb3d40856e7d222ae0069b6e6296877</div><div>Status: Downloaded newer image for postgres:9.6.1</div><div>ca35482b379bb55f9db21c1537fda9133a2b9cded5a13889a5528ed1e8b7d149</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls</span></div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</div><div>ca35482b379b        postgres:9.6.1      &quot;/docker-entrypoint.…&quot;   12 seconds ago      Up 11 seconds       0.0.0.0:5432-&gt;5432/tcp              postgres</div><div>23e3e0ee2cbb        nginx               &quot;nginx -g 'daemon of…&quot;   3 hours ago         Up 3 hours          0.0.0.0:8082-&gt;80/tcp                nginx2</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container logs ca35</span></div><div>The files belonging to this database system will be owned by user &quot;postgres&quot;.</div><div>This user must also own the server process.</div><div>...</div><div>LOG:  autovacuum launcher shutting down</div><div>waiting for server to shut down....LOG:  shutting down</div><div>LOG:  database system is shut down</div><div>done</div><div>server stopped</div><div><br/></div><div>PostgreSQL init process complete; ready for start up.</div><div><br/></div><div>LOG:  database system was shut down at 2018-11-02 09:54:48 UTC</div><div>LOG:  MultiXact member wraparound protections are now enabled</div><div>LOG:  database system is ready to accept connections</div><div>LOG:  autovacuum launcher started</div><div><br/></div><div><br/></div><div>danev@ora-vsrv:~$ <span style="font-size: 12pt; font-weight: bold;">docker</span> <span style="font-size: 12pt;"><span style="font-size: 12pt; font-weight: bold;">container </span></span><span style="font-size: 12pt; font-weight: bold;">run -d --name postgres2 -p 5432:5432 -e http_proxy=</span><a href="http://10.1.32.100:8080/" style="font-size: 12pt; font-weight: bold;">http://10.1.32.100:8080</a> <span style="font-size: 12pt; font-weight: bold;">-v postgres:/var/lib/postgresql/data postgres:9.6.2</span></div><div>Unable to find image 'postgres:9.6.2' locally</div><div>9.6.2: Pulling from library/postgres</div><div>10a267c67f42: Pull complete</div><div>..</div><div>Digest: sha256:5284ba74a1065e34cf1bfccd64caf8c497c8dc623d6207b060b5ebd369427d34</div><div>Status: Downloaded newer image for postgres:9.6.2</div><div>04f6d4023e7681c283a8ef82c06e5ff1cb2619145badff28db9dfc23e32f5671</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container ls</span></div><div>CONTAINER ID        IMAGE               COMMAND                  CREATED             STATUS              PORTS                               NAMES</div><div>04f6d4023e76        postgres:9.6.2      &quot;docker-entrypoint.s…&quot;   19 seconds ago      Up 19 seconds       0.0.0.0:5432-&gt;5432/tcp              postgres2</div><div>23e3e0ee2cbb        nginx               &quot;nginx -g 'daemon of…&quot;   3 hours ago         Up 3 hours          0.0.0.0:8082-&gt;80/tcp                nginx2</div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker volume ls</span></div><div>DRIVER              VOLUME NAME</div><div>local               11aedc88a6f8bd1bca7400eb97e3d128aa026d9192875bdb4d1fbfcb61c9ff50</div><div>...</div><div>local               mysql-db</div><div>local               postgres</div><div><br/></div><div>danev@ora-vsrv:~$ <span style="font-weight: bold;">docker container logs -f postgres2</span></div><div>LOG:  database system was shut down at 2018-11-02 10:19:24 UTC</div><div>LOG:  MultiXact member wraparound protections are now enabled</div><div>LOG:  autovacuum launcher started</div><div>LOG:  database system is ready to accept connections</div><div><br/></div><div><span style="font-weight: bold;">-f command so that it keeps watching as it runs </span></div><div><br/></div><div>vdanev@ora-vsrv:~$ <span style="font-weight: bold;">docker container logs 04f</span></div><div>LOG:  database system was shut down at 2018-11-02 10:19:24 UTC</div><div>LOG:  MultiXact member wraparound protections are now enabled</div><div>LOG:  autovacuum launcher started</div><div>LOG:  database system is ready to accept connections</div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [7].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>1</div><div>vdanev@ora-vsrv:~/docker/udemy-docker-mastery/bindmount-sample-1$ <span style="font-weight: bold;">docker run -p 80:4000 -e http_proxy=</span><a href="http://10.1.32.100:8081/" style="font-weight: bold;">http://10.1.32.100:8081</a> <span style="font-weight: bold;">-e https_proxy=</span><a href="http://10.1.32.100:8081/" style="font-weight: bold;">http://10.1.32.100:8081</a> <span style="font-weight: bold;">-v $(pwd):/site bretfisher/jekyll-serve</span></div><div>The dependency tzinfo-data (&gt;= 0) will be unused by any of the platforms Bundler is installing for. Bundler is installing for ruby but the dependency is only for x86-mingw32, x86-mswin32, x64-mingw32, java. To add those platforms to the bundle, run `bundle lock --add-platform x86-mingw32 x86-mswin32 x64-mingw32 java`.</div><div>Fetching gem metadata from <a href="https://rubygems.org/">https://rubygems.org/</a>...........</div><div>Fetching gem metadata from <a href="https://rubygems.org/">https://rubygems.org/</a>.</div><div>Resolving dependencies...</div><div>Using public_suffix 3.0.3</div><div>...</div><div>Installing minima 2.5.0</div><div>Bundle complete! 4 Gemfile dependencies, 29 gems now installed.</div><div>Bundled gems are installed into `/usr/local/bundle`</div><div>Configuration file: /site/_config.yml</div><div>       Deprecation: The 'gems' configuration option has been renamed to 'plugins'. Please update your config file accordingly.</div><div>            Source: /site</div><div>       Destination: /site/_site</div><div>Incremental build: disabled. Enable with --incremental</div><div>      Generating...</div><div>       Jekyll Feed: Generating feed for posts</div><div>                    done in 0.513 seconds.</div><div>Auto-regeneration: enabled for '/site'</div><div>    Server address: <a href="http://0.0.0.0:4000/">http://0.0.0.0:4000/</a></div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [8].png" type="image/png" data-filename="Image.png"/></div><div>Редактируем текст:</div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [9].png" type="image/png" data-filename="Image.png"/></div><div>В файле ниже и сохраняем:</div><div>/docker/udemy-docker-mastery/bindmount-sample-1/_posts/2017-03-05-welcome-to-jekyll.markdown</div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">Процесс обнаруживает изменившиеся файлы...</span></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [10].png" type="image/png" data-filename="Image.png"/></div><div><font style="font-size: 12pt;"><br/></font></div><div><span style="font-size: 12pt; font-weight: bold;">Рефреш браузера показывает эти изменения:</span></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [11].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>Это благодаря возможностям  <span style="font-weight: bold;">Jekyll — генератор статичных сайтов:</span></div><div><a href="https://guides.hexlet.io/jekyll/">https://guides.hexlet.io/jekyll/</a></div><div><br/></div><div><br/></div><div><img src="Docker_Mastery_course-1_hometasks.enex_files/Image [12].png" type="image/png" data-filename="Image.png"/></div><div><br/></div><div>df</div><div><br/></div><div><br/></div></span>
</div></body></html> 